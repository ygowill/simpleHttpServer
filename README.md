# è®¡ç®—æœºç½‘ç»œä½œä¸šç›¸å…³è¯´æ˜
ç§¦é”´ 2016220302008

ä¸€ä¸ªè®¡ç®—æœºç½‘ç»œçš„å°ä½œä¸šï¼Œå®Œæˆä¸€æ¬¡ç®€å•httpè¯·æ±‚çš„åˆ†æ

## ç›®å½•ç»“æ„

    .
    â”œâ”€â”€ Log
    â”‚Â Â  â”œâ”€â”€ error.log
    â”‚Â Â  â””â”€â”€ log.log
    â”œâ”€â”€ README.md
    â”œâ”€â”€ out
    â”‚Â Â  â”œâ”€â”€ artifacts
    â”‚Â Â  â”‚Â Â  â””â”€â”€ simpleHttpServer_jar
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ dom4j-1.6.1.jar
    â”‚Â Â  â”‚Â Â      â”œâ”€â”€ log4j-1.2.17.jar
    â”‚Â Â  â”‚Â Â      â””â”€â”€ simpleHttpServer.jar
    â”‚Â Â  â””â”€â”€ production
    â”‚Â Â      â””â”€â”€ simpleHttpServer
    â”‚Â Â          â”œâ”€â”€ 404.html
    â”‚Â Â          â”œâ”€â”€ META-INF
    â”‚Â Â          â”‚Â Â  â””â”€â”€ MANIFEST.MF
    â”‚Â Â          â”œâ”€â”€ UI
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ Entry.class
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ HttpServerUI$1.class
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ HttpServerUI$2.class
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ HttpServerUI$3.class
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ HttpServerUI$4.class
    â”‚Â Â          â”‚Â Â  â””â”€â”€ HttpServerUI.class
    â”‚Â Â          â”œâ”€â”€ context
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ Context.class
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ Request.class
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ Response.class
    â”‚Â Â          â”‚Â Â  â””â”€â”€ impl
    â”‚Â Â          â”‚Â Â      â”œâ”€â”€ HttpContext.class
    â”‚Â Â          â”‚Â Â      â”œâ”€â”€ HttpRequest.class
    â”‚Â Â          â”‚Â Â      â””â”€â”€ HttpResponse.class
    â”‚Â Â          â”œâ”€â”€ handler
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ Handler.class
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ HttpHandler.class
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ MapHandler.class
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ ResponseHandler.class
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ abs
    â”‚Â Â          â”‚Â Â  â”‚Â Â  â””â”€â”€ AbstractHandler.class
    â”‚Â Â          â”‚Â Â  â””â”€â”€ impl
    â”‚Â Â          â”‚Â Â      â”œâ”€â”€ HomeHandler.class
    â”‚Â Â          â”‚Â Â      â”œâ”€â”€ NotFoundHandler.class
    â”‚Â Â          â”‚Â Â      â””â”€â”€ PicHandler.class
    â”‚Â Â          â”œâ”€â”€ home.html
    â”‚Â Â          â”œâ”€â”€ lib
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ dom4j-1.6.1.jar
    â”‚Â Â          â”‚Â Â  â””â”€â”€ log4j-1.2.17.jar
    â”‚Â Â          â”œâ”€â”€ log4j.properties
    â”‚Â Â          â”œâ”€â”€ res
    â”‚Â Â          â”‚Â Â  â””â”€â”€ garfield.jpeg
    â”‚Â Â          â”œâ”€â”€ server
    â”‚Â Â          â”‚Â Â  â””â”€â”€ Server.class
    â”‚Â Â          â”œâ”€â”€ server.xml
    â”‚Â Â          â”œâ”€â”€ utils
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ LogAppender.class
    â”‚Â Â          â”‚Â Â  â”œâ”€â”€ TextAreaLogAppender.class
    â”‚Â Â          â”‚Â Â  â””â”€â”€ XMLUtil.class
    â”‚Â Â          â””â”€â”€ web.xml
    â”œâ”€â”€ project.uml
    â”œâ”€â”€ simpleHttpServer.iml
    â”œâ”€â”€ simpleHttpServer.udb
    â””â”€â”€ src
        â”œâ”€â”€ 404.html
        â”œâ”€â”€ META-INF
        â”‚Â Â  â””â”€â”€ MANIFEST.MF
        â”œâ”€â”€ UI
        â”‚Â Â  â”œâ”€â”€ Entry.java
        â”‚Â Â  â””â”€â”€ HttpServerUI.java
        â”œâ”€â”€ context
        â”‚Â Â  â”œâ”€â”€ Context.java
        â”‚Â Â  â”œâ”€â”€ Request.java
        â”‚Â Â  â”œâ”€â”€ Response.java
        â”‚Â Â  â””â”€â”€ impl
        â”‚Â Â      â”œâ”€â”€ HttpContext.java
        â”‚Â Â      â”œâ”€â”€ HttpRequest.java
        â”‚Â Â      â””â”€â”€ HttpResponse.java
        â”œâ”€â”€ handler
        â”‚Â Â  â”œâ”€â”€ Handler.java
        â”‚Â Â  â”œâ”€â”€ HttpHandler.java
        â”‚Â Â  â”œâ”€â”€ MapHandler.java
        â”‚Â Â  â”œâ”€â”€ ResponseHandler.java
        â”‚Â Â  â”œâ”€â”€ abs
        â”‚Â Â  â”‚Â Â  â””â”€â”€ AbstractHandler.java
        â”‚Â Â  â””â”€â”€ impl
        â”‚Â Â      â”œâ”€â”€ HomeHandler.java
        â”‚Â Â      â”œâ”€â”€ NotFoundHandler.java
        â”‚Â Â      â””â”€â”€ PicHandler.java
        â”œâ”€â”€ home.html
        â”œâ”€â”€ lib
        â”‚Â Â  â”œâ”€â”€ dom4j-1.6.1.jar
        â”‚Â Â  â””â”€â”€ log4j-1.2.17.jar
        â”œâ”€â”€ log4j.properties
        â”œâ”€â”€ res
        â”‚Â Â  â””â”€â”€ garfield.jpeg
        â”œâ”€â”€ server
        â”‚Â Â  â””â”€â”€ Server.java
        â”œâ”€â”€ server.xml
        â”œâ”€â”€ utils
        â”‚Â Â  â”œâ”€â”€ LogAppender.java
        â”‚Â Â  â”œâ”€â”€ TextAreaLogAppender.java
        â”‚Â Â  â””â”€â”€ XMLUtil.java
        â””â”€â”€ web.xml

## å¯æ‰§è¡Œjarä»¥åŠä½¿ç”¨æ–¹æ³•

å¯æ‰§è¡ŒjaråŒ…ä½äº ./out/artifacts/simpleHttpServer_jar/simpleHttpServer.jar

é¦–å…ˆè¿›å…¥é¡¹ç›®æ ¹ç›®å½•ï¼Œå³åœ¨simpleHttpServeræ–‡ä»¶å¤¹ä¸‹

ç„¶åä½¿ç”¨ java -jar ./out/artifacts/simpleHttpServer.jar å³å¯è¿è¡Œæœ¬æœåŠ¡å™¨

## æºç è¯´æ˜

æºç ä½äº ./src å†…

### contextäº¤äº’åŒ…

**context**åŒ…å†…ä¸ºäº¤äº’ç›¸å…³æ¥å£ï¼Œå…¶ä¸­çš„**impl**æ–‡ä»¶å¤¹å†…ä¸ºç›¸å…³æ¥å£çš„å®ç°ç±»

å¯¹äºäº¤äº’ï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ª*Request*æ¥å£å’Œä¸€ä¸ª*Response*æ¥å£ä»¥åŠä¸€ä¸ª**Context**æŠ½è±¡ç±»ï¼Œè¿™ä¸ªæŠ½è±¡ç±»ç”¨ä»¥è·å–äº¤äº’ä¿¡æ¯ï¼Œä»¥åŠè®¾ç½®èµ„æºç­‰ï¼Œä½äºimplåŒ…å†…çš„å³ä¸ºè¿™äº›æ¥å£å’ŒæŠ½è±¡ç±»çš„å®ç°ç±»ã€‚

### handleré¡µé¢å¤„ç†åŒ…

**handler**åŒ…å†…ä¸ºé¡µé¢ç›¸å…³å¤„ç†æ¥å£å’Œç±»ï¼Œå…¶ä¸­çš„**abs**æ–‡ä»¶å¤¹å†…æœ‰**handler**çš„æŠ½è±¡ç±»ï¼Œ**impl**æ–‡ä»¶å¤¹å†…æœ‰æŠ½è±¡ç±»çš„å®ç°ç±»ã€‚

å…¶ä¸­*MapHandler*ç”¨ä»¥è§£æ*web.xml*ï¼Œä»¥å®Œæˆ*uri*åˆ°å¯¹åº”*handler*çš„æ˜ å°„ã€‚*httpHandler*è´Ÿè´£å¤„ç†ä¸€æ¬¡*http*è¯·æ±‚ï¼Œé€šè¿‡ä¸åŒçš„uriå¯åŠ¨ä¸åŒçš„handlerè¿›è¡Œå¤„ç†ã€‚*ResponseHandler*è´Ÿè´£å¤„ç†é¡µé¢çš„å“åº”ç»“æœã€‚å¯¹äºç›¸å…³é¡µé¢å¤„ç†çš„*handler*ï¼Œæˆ‘é¦–å…ˆå†™äº†ä¸€ä¸ª*handler*çš„æ¥å£ï¼Œç„¶åå¯¹äºè¿™ä¸ªæ¥å£æˆ‘å†™äº†ä¸€ä¸ª*AbstractHandler*æŠ½è±¡ç±»ï¼Œç›¸å…³é¡µé¢å¤„ç†çš„*handler*åªéœ€é‡å†™æŠ½è±¡ç±»çš„æ–¹æ³•å³å¯

### libä»¥åŠlibèµ„æºåŒ…

**lib**æ–‡ä»¶å¤¹å†…ä¸ºæ‰€ç”¨åˆ°çš„*jar*åŒ…

**res**æ–‡ä»¶å¤¹å†…ä¸ºæ‰€ç”¨åˆ°çš„å›¾ç‰‡

### META-INFæ–‡ä»¶å¤¹

**META-INF**æ–‡ä»¶å¤¹å†…ä¸º*main class*ä¿¡æ¯

### serveræœåŠ¡å™¨åŒ…

**server**æ–‡ä»¶å¤¹å†…ä¸ºæœåŠ¡å™¨ç±»

ä½¿ç”¨java nioè¿›è¡Œç›‘å¬ï¼Œå®ŒæˆæœåŠ¡å™¨ç›‘å¬çº¿ç¨‹

### UIé¡µé¢æ˜¾ç¤ºåŒ…

**UI**æ–‡ä»¶å¤¹å†…ä¸º*main class*ä»¥åŠ*GUI*ç›¸å…³ç±»

**HttpServerUi**ä¸»è¦å®Œæˆäº†é¡µé¢çš„è®¾ç½®ï¼Œç”¨æˆ·åŠ¨ä½œçš„ç›‘å¬ï¼Œä»¥åŠlog4jçš„è¾“å‡ºç®¡é“ç»‘å®šï¼Œè€Œ**Entry**åˆ™æ˜¯æ•´ä¸ªç¨‹åºçš„å…¥å£

### utilsè¾…åŠ©ç±»åŒ…

**utils**å†…ä¸ºè¾…åŠ©ç±»ï¼Œ**LogAppender**ä¸ºlog4jçš„æ‰©å±•è™šæ‹Ÿç±»ï¼Œå…¶å°†log4jçš„è¾“å‡ºä¼ ç»™ç®¡é“ï¼Œç„¶åé€åˆ°GUIç»„ä»¶ä¸­æ˜¾ç¤ºï¼Œ**TextAreaLogAppender**åˆ™æ˜¯LogAppenderçš„å…·ä½“å®ç°ç±»ï¼Œå®Œæˆäº†å°†ç®¡é“çš„å†…å®¹æ·»åŠ åˆ°ç›¸å…³textareaä¸­å¹¶å®ç°äº†ï¼Œæ»šåŠ¨æ¡è‡ªåŠ¨è·Ÿéšæ»šåŠ¨åˆ°æœ€åã€‚è‡³äº**XMLUtil**åˆ™è´Ÿè´£å®Œæˆå¯¹xmlæ–‡ä»¶çš„è§£æå’Œæ›´æ–°

### å…¶ä»–

é™¤æ­¤ä»¥å¤–ï¼Œ**web.xml**æ–‡ä»¶ç”¨äºé…ç½®é¡µé¢çš„ç›¸å…³*handler*æ˜ å°„ï¼Œ**server.xml**ç”¨äºé…ç½®æœåŠ¡å™¨çš„ç›¸å…³ä¿¡æ¯ï¼Œ**log4j.properties**ç”¨äºé…ç½®*log4j*çš„è¾“å‡ºï¼Œå¦å¤–ä¸¤ä¸ª*html*æ–‡ä»¶åˆ†åˆ«ä¸ºä¸»é¡µé¢ä»¥åŠ404é¡µé¢

## æ—¥å¿—

æ—¥å¿—å…±æœ‰ä¸¤ä¸ªåˆ†åˆ«ä¸º**error.log**ä»¥åŠ**log.log**ï¼Œåˆ†åˆ«ç”¨äºå­˜å‚¨é”™è¯¯æ—¥å¿—å’Œæ™®é€šæ—¥å¿—

## OUT

**out**æ–‡ä»¶å¤¹å†…çš„**production**æ–‡ä»¶å¤¹å†…ä¸ºæºç ç¼–è¯‘å‡ºçš„classæ–‡ä»¶ï¼Œ**artifacts**æ–‡ä»¶å¤¹å†…ä¸ºé¡¹ç›®æ‰“åŒ…åçš„*jar*åŒ…

## æ·»åŠ é¡µé¢æˆ–æ“ä½œ

è¿™ä¸ªé¡¹ç›®ä¸ºäº†è‰¯å¥½çš„æ‰©å±•æ€§ä½¿ç”¨äº†ä¸€é€šè‡ªå·±éƒ½å¿«çœ‹ä¸æ‡‚çš„æ“ä½œï¼Œç®€è€Œè¨€ä¹‹ï¼Œä¸ºä¸åŒçš„å¯¹è±¡åˆ›å»ºä¸åŒçš„handlerå³å¯ï¼Œå°±åƒhandler/implæ–‡ä»¶å¤¹å†…æ¼”ç¤ºçš„é‚£æ ·,ä¸ºhtmlå†…çš„ä¸åŒçš„å¯¹è±¡åˆ›å»ºhandleræ¥å®Œæˆä¸åŒçš„æ“ä½œï¼Œç„¶åå°†æ­¤handleråŠ å…¥web.xmlå†…å³å¯

ğŸ‰å®Œç»“æ’’èŠ±ğŸ‰
